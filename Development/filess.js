const months=["January","February","March","April","May","June","July","August","September","October","November","December"];date=new Date,refinedDate=`${months[date.getMonth()]} ${date.getDate()}`;const regExp=/[0-9]/,userID=getUser().userId,cifLength=8,className=["bounce","shakeX","shakeY","pulse","backInUp","backInDown","bounceIn","fadeInUp","lightSpeedInLeft"],label_Contact=["Accounts","Credit_card","Debit_card","Liv_Cash","Liv_Insurance","Liv_Prime","Liv_USD","Liv_Young"],dateOptions={weekday:"long",year:"numeric",month:"long",day:"numeric"},dateNow=new Date().toLocaleDateString("en-US",dateOptions);$(document).ready(function(){$("#dateToday").val(dateNow)}),$("#staffName").val(getUser().fullName);var myAlert=document.getElementById("toastNotice"),bsAlert=new bootstrap.Toast(myAlert,{animation:!0,autohide:!0,delay:5e3}),rand=function(){var a=Math.random();return a=Math.floor(a*className.length),a};$("#layout3").addClass("animate__"+className[rand()]);var uniqueLabels,uniqueSubLabels,tempArrLabels=[],tempArrSubLabels=[];function loadLabelS(a){gettItems(a,null)}function loadSubLabels(a){var b=$("#labelViaCont").val();gettItems(b,a)}function createLabelSelection(){$("#LabelVal").html(""),$("#subLabeled").html(""),$("#LabelVal").append("<option value=\"\">--Select--</option>"),uniqueLabels.forEach(a=>$("#LabelVal").append(`<option value="${a}">${a}</option>`))}function createSubLabelSelection(){$("#subLabeled").html(""),uniqueSubLabels.forEach(a=>$("#subLabeled").append(`<option value="${a}">${a}</option>`))}function gettItems(a,b){null==b?tempArrLabels=[]:tempArrSubLabels=[];var c=null==b?"(labelVIaContact eq  '"+a+"')&$orderby=Label asc":"(Label eq '"+b+"') and (labelVIaContact eq '"+a+"')&$select=subLabel&$orderby=subLabel asc";var d=_spPageContextInfo.webAbsoluteUrl+"/_api/web/lists/getbytitle('Liv_Pending_Chat')/items?$top=1000&$filter="+c;$.ajax({url:d,type:"GET",headers:{accept:"application/json; odata=verbose"},success:function(a){var c=a.d.results;null==b?c.forEach(a=>tempArrLabels.push(a.Label)):c.forEach(a=>tempArrSubLabels.push(a.subLabel)),null==b?getUniqs("L"):getUniqs("subL")},error:function(){console.log("Error")}})}function getUniqs(a){"subL"==a?uniqueSubLabels=[]:uniqueLabels=[],"subL"==a?uniqueSubLabels=tempArrSubLabels.filter(onlyUnique):uniqueLabels=tempArrLabels.filter(onlyUnique),"subL"==a?createSubLabelSelection():createLabelSelection()}function onlyUnique(a,b,c){return c.indexOf(a)===b}function submitRecord(){const a=$("#emailID").val(),b=$("#labelViaCont").val(),c=$("#LabelVal").val(),d=$("#subLabeled").val();console.log([a,b,c,d]);var e={__metadata:{type:"SP.Data.Liv_x005f_Chats_x005f_labelingListItem"},Title:`${userID}`,Mobile_Number:a,Label_via_Contact_type:b,Label:c,Sub_Label:d,manualDateToday:refinedDate};""==a||null==a||""==b||""==c||null==c||""==d||null==d?alert("Please fill all fields"):(addItemToList(e),bsAlert.show(),setTimeout(()=>{window.location.reload()},500))}function addItemToList(a){$.ajax({url:_spPageContextInfo.webAbsoluteUrl+"/_api/Web/Lists/GetByTitle('Liv_Chats_labeling_Report')/items",type:"POST",async:!1,contentType:"application/json;odata=verbose",data:JSON.stringify(a),headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val()},success:function(a){console.log(a)},error:function(a){console.log(a)}})}




const m=["January","February","March","April","May","June","July","August","September","October","November","December"],d=new Date,rd=${m[d.getMonth()]} ${d.getDate()},re=/[0-9],uid=getUser().userId,cl=8,c=["bounce","shakeX","shakeY","pulse","backInUp","backInDown","bounceIn","fadeInUp","lightSpeedInLeft"],lc=["Accounts","Credit_card","Debit_card","Liv_Cash","Liv_Insurance","Liv_Prime","Liv_USD","Liv_Young"],o={weekday:"long",year:"numeric",month:"long",day:"numeric"},dn=new Date().toLocaleDateString("en-US",o);$(document).ready(()=>$("#dateToday").val(dn)),$("#staffName").val(getUser().fullName);var a=document.getElementById("toastNotice"),b=new bootstrap.Toast(a,{animation:!0,autohide:!0,delay:5e3});$("#layout3").addClass(animate__${c[(()=>{var a=Math.random();return Math.floor(a*c.length)})()]});var ul,usl,t=[],ts=[];function l(a){g(a,null)}function ls(a){var b=$("#labelViaCont").val();g(b,a)}function cls(){$("#LabelVal").html(""),$("#subLabeled").html(""),$("#LabelVal").append("<option value="">--Select--</option>"),ul.forEach(a=>$("#LabelVal").append(<option value="${a}">${a}</option>))}function csl(){$("#subLabeled").html(""),usl.forEach(a=>$("#subLabeled").append(<option value="${a}">${a}</option>))}function g(a,b){null==b?t=[]:ts=[];var c=null==b?"(labelVIaContact eq '"+a+"')&$orderby=Label asc":"(Label eq '"+b+"') and (labelVIaContact eq '"+a+"')&$select=subLabel&$orderby=subLabel asc";var d=_spPageContextInfo.webAbsoluteUrl+"/_api/web/lists/getbytitle('Liv_Pending_Chat')/items?$top=1000&$filter="+c;$.ajax({url:d,type:"GET",headers:{accept:"application/json; odata=verbose"},success:function(c){var d=c.d.results;null==b?d.forEach(c=>t.push(c.Label)):d.forEach(c=>ts.push(c.subLabel)),null==b?u("L"):u("subL")},error:()=>console.log("Error")})}function u(a){"subL"==a?usl=[]:ul=[],"subL"==a?usl=ts.filter(o):ul=t.filter(o),"subL"==a?csl():cls()



const months=["January","February","March","April","May","June","July","August","September","October","November","December"],regExp=/[0-9]/,userID=_spPageContextInfo.userId,fullName=_spPageContextInfo.userDisplayName,className=["bounce","shakeX","shakeY","pulse","backInUp","backInDown","bounceIn","fadeInUp","lightSpeedInLeft"],label_Contact=["Accounts","Credit_card","Debit_card","Liv_Cash","Liv_Insurance","Liv_Prime","Liv_USD","Liv_Young"];function dateTimeNow(){const a=new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}),b=new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),c=new Date().toLocaleDateString("en-US",{month:"long"}),d=new Date().toLocaleDateString("en-US",{month:"long",day:"numeric"}),e=new Date().toLocaleDateString("en-US",{year:"numeric"});return{dateTimeNow:a,dateOnlyNow:b,dateOnlyMonth:c,dateDayMonthOnly:d,yearOnly:e}}const filters="(SPTUID eq '"+userID+"') and (Date eq '"+dateTimeNow().dateDayMonthOnly+"')";GetItemWithCB(filters,a=>{if(0<a.d.results.length){const b=JSON.parse(a.d.results[0].Content),c=100<b.length?`100+`:b.length;$("#labelsCount").html(`${c}`),$(".bs-badge").fadeIn(1e3)}}),$(document).ready(function(){$("#dateToday").val(dateTimeNow().dateOnlyNow),$("#staffName").val(fullName)});let myAlert=document.getElementById("toastNotice"),bsAlert=new bootstrap.Toast(myAlert,{animation:!0,autohide:!0,delay:5e3}),rand=function(){let a=Math.random();return a=Math.floor(a*className.length),a};$("#layout3").addClass("animate__"+className[rand()]);let uniqueLabels,uniqueSubLabels,tempArrLabels=[],tempArrSubLabels=[];function loadLabelS(a){gettItems(a,null)}function loadSubLabels(a){let b=$("#labelViaCont").val();gettItems(b,a)}function createLabelSelection(){$("#LabelVal").html(""),$("#subLabeled").html(""),$("#LabelVal").append("<option value=\"\">--Select--</option>"),uniqueLabels.forEach(a=>$("#LabelVal").append(`<option value="${a}">${a}</option>`))}function createSubLabelSelection(){$("#subLabeled").html(""),uniqueSubLabels.forEach(a=>$("#subLabeled").append(`<option value="${a}">${a}</option>`))}function gettItems(a,b){null==b?tempArrLabels=[]:tempArrSubLabels=[];let c=null==b?"(Title eq  '"+a+"')&$orderby=Label asc":"(Label eq '"+b+"') and (Title eq '"+a+"')&$select=subLabel&$orderby=subLabel asc";let d=_spPageContextInfo.webAbsoluteUrl+"/_api/web/lists/getbytitle('Liv_Chat_Labels')/items?$top=1000&$filter="+c;$.ajax({url:d,type:"GET",headers:{accept:"application/json; odata=verbose"},success:function(a){let c=a.d.results;null==b?c.forEach(a=>tempArrLabels.push(a.Label)):c.forEach(a=>tempArrSubLabels.push(a.subLabel)),null==b?getUniqs("L"):getUniqs("subL")},error:function(){console.log("Error")}})}function getUniqs(a){"subL"==a?uniqueSubLabels=[]:uniqueLabels=[],"subL"==a?uniqueSubLabels=tempArrSubLabels.filter(onlyUnique):uniqueLabels=tempArrLabels.filter(onlyUnique),"subL"==a?createSubLabelSelection():createLabelSelection()}function onlyUnique(a,b,c){return c.indexOf(a)===b}function submitRecord(){const a=$("#mobileNumber").val(),b=$("#segment").val(),c=$("#labelViaCont").val(),d=$("#LabelVal").val(),e=$("#subLabeled").val();if(console.log(dateTimeNow().yearOnly),""==a||null==a||""==b||""==c||""==d||null==d||""==e||null==e)return alert("Please fill all fields correctly"),!1;$("button,input,select").prop("disabled",!0);const f={Mob:a,Segment:b,Label1:c,Label2:d,Label3:e,Date:dateTimeNow().dateTimeNow},g="(SPTUID eq '"+userID+"') and (Date eq '"+dateTimeNow().dateDayMonthOnly+"')";GetItemWithCB(g,a=>{if(0===a.d.results.length){console.log("New entry for today");const a={__metadata:{type:"SP.Data.Liv_x005f_Chats_x005f_labeling_x005f_ReportListItem"},Title:_spPageContextInfo.userEmail.split("@")[0],SPTUID:userID.toString(),Date:dateTimeNow().dateDayMonthOnly,Month:dateTimeNow().dateOnlyMonth,Year:dateTimeNow().yearOnly,Content:`[${JSON.stringify(f)}]`};addItemToList(a)}else{const b=JSON.parse(a.d.results[0].Content),c=a.d.results[0].ID;b.push(f);const d={__metadata:{type:"SP.Data.Liv_x005f_Chats_x005f_labeling_x005f_ReportListItem"},Content:`${JSON.stringify(b)}`};updateSpecificListItem(d,c),console.log("update existing entry for today")}})}function GetItemWithCB(a,b){$.ajax({url:_spPageContextInfo.webAbsoluteUrl+"/_api/Web/Lists/GetByTitle('Liv_Chats_labeling_Report')/items?$filter="+a,method:"GET",async:!0,headers:{Accept:"application/json; odata=verbose"},success:function(a){b(a)},error:function(a){console.log(a)}})}function addItemToList(a){$.ajax({url:_spPageContextInfo.webAbsoluteUrl+"/_api/Web/Lists/GetByTitle('Liv_Chats_labeling_Report')/items",type:"POST",async:!1,contentType:"application/json;odata=verbose",data:JSON.stringify(a),headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val()},success:function(){reload()},error:function(a){alert("There was an error, please refresh and try again  or contact TL"),console.log(a)}})}function updateSpecificListItem(a,b){$.ajax({url:_spPageContextInfo.webAbsoluteUrl+"/_api/Web/Lists/GetByTitle('Liv_Chats_labeling_Report')/items("+b+")",type:"POST",data:JSON.stringify(a),contentType:"application/json;odata=verbose",headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"X-HTTP-Method":"MERGE","If-Match":"*"},success:function(){},error:function(a){alert("There was an error, please refresh and try again or contact TL"),console.log(a)}})}function reload(){bsAlert.show(),setTimeout(()=>{window.location.reload()},2e3)}$(".todayItems").on("click",()=>{location.href="liv-label-UserPage.aspx"});




const months=["January","February","March","April","May","June","July","August","September","October","November","December"],regExp=/[0-9]/,userID=_spPageContextInfo.userId,fullName=_spPageContextInfo.userDisplayName,className=["bounce","shakeX","shakeY","pulse","backInUp","backInDown","bounceIn","fadeInUp","lightSpeedInLeft"],label_Contact=["Accounts","Credit_card","Debit_card","Liv_Cash","Liv_Insurance","Liv_Prime","Liv_USD","Liv_Young"];function dateTimeNow(){const a=new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}),b=new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),c=new Date().toLocaleDateString("en-US",{month:"long"}),d=new Date().toLocaleDateString("en-US",{month:"long",day:"numeric"}),e=new Date().toLocaleDateString("en-US",{year:"numeric"});return{dateTimeNow:a,dateOnlyNow:b,dateOnlyMonth:c,dateDayMonthOnly:d,yearOnly:e}}const filters="(SPTUID eq '"+userID+"') and (Date eq '"+dateTimeNow().dateDayMonthOnly+"')";GetItemWithCB(filters,a=>{if(0<a.d.results.length){const b=JSON.parse(a.d.results[0].Content),c=100<b.length?`100+`:b.length;$("#labelsCount").html(`${c}`),$(".bs-badge").fadeIn(1e3)}}),$(document).ready(function(){$("#dateToday").val(dateTimeNow().dateOnlyNow),$("#staffName").val(fullName)});let myAlert=document.getElementById("toastNotice"),bsAlert=new bootstrap.Toast(myAlert,{animation:!0,autohide:!0,delay:5e3}),rand=function(){let a=Math.random();return a=Math.floor(a*className.length),a};$("#layout3").addClass("animate__"+className[rand()]);let uniqueLabels,uniqueSubLabels,tempArrLabels=[],tempArrSubLabels=[];function loadLabelS(a){gettItems(a,null)}function loadSubLabels(a){let b=$("#labelViaCont").val();gettItems(b,a)}function createLabelSelection(){$("#LabelVal").html(""),$("#subLabeled").html(""),$("#LabelVal").append("<option value=\"\">--Select--</option>"),uniqueLabels.forEach(a=>$("#LabelVal").append(`<option value="${a}">${a}</option>`))}function createSubLabelSelection(){$("#subLabeled").html(""),uniqueSubLabels.forEach(a=>$("#subLabeled").append(`<option value="${a}">${a}</option>`))}function gettItems(a,b){null==b?tempArrLabels=[]:tempArrSubLabels=[];let c=null==b?"(Title eq  '"+a+"')&$orderby=Label asc":"(Label eq '"+b+"') and (Title eq '"+a+"')&$select=subLabel&$orderby=subLabel asc";let d=_spPageContextInfo.webAbsoluteUrl+"/_api/web/lists/getbytitle('Liv_Chat_Labels')/items?$top=1000&$filter="+c;$.ajax({url:d,type:"GET",headers:{accept:"application/json; odata=verbose"},success:function(a){let c=a.d.results;null==b?c.forEach(a=>tempArrLabels.push(a.Label)):c.forEach(a=>tempArrSubLabels.push(a.subLabel)),null==b?getUniqs("L"):getUniqs("subL")},error:function(){console.log("Error")}})}function getUniqs(a){"subL"==a?uniqueSubLabels=[]:uniqueLabels=[],"subL"==a?uniqueSubLabels=tempArrSubLabels.filter(onlyUnique):uniqueLabels=tempArrLabels.filter(onlyUnique),"subL"==a?createSubLabelSelection():createLabelSelection()}function onlyUnique(a,b,c){return c.indexOf(a)===b}function submitRecord(){const a=$("#mobileNumber").val(),b=$("#segment").val(),c=$("#labelViaCont").val(),d=$("#LabelVal").val(),e=$("#subLabeled").val();if(console.log(dateTimeNow().yearOnly),""==a||null==a||""==b||""==c||""==d||null==d||""==e||null==e)return alert("Please fill all fields correctly"),!1;$("button,input,select").prop("disabled",!0);const f={Mob:a,Segment:b,Label1:c,Label2:d,Label3:e,Date:dateTimeNow().dateTimeNow},g="(SPTUID eq '"+userID+"') and (Date eq '"+dateTimeNow().dateDayMonthOnly+"')";GetItemWithCB(g,a=>{if(0===a.d.results.length){console.log("New entry for today");const a={__metadata:{type:"SP.Data.Liv_x005f_Chats_x005f_labeling_x005f_ReportListItem"},Title:_spPageContextInfo.userEmail.split("@")[0],SPTUID:userID.toString(),Date:dateTimeNow().dateDayMonthOnly,Month:dateTimeNow().dateOnlyMonth,Year:dateTimeNow().yearOnly,Content:`[${JSON.stringify(f)}]`};addItemToList(a)}else{const b=JSON.parse(a.d.results[0].Content),c=a.d.results[0].ID;b.push(f);const d={__metadata:{type:"SP.Data.Liv_x005f_Chats_x005f_labeling_x005f_ReportListItem"},Content:`${JSON.stringify(b)}`};updateSpecificListItem(d,c),console.log("update existing entry for today")}})}function GetItemWithCB(a,b){$.ajax({url:_spPageContextInfo.webAbsoluteUrl+"/_api/Web/Lists/GetByTitle('Liv_Chats_labeling_Report')/items?$filter="+a,method:"GET",async:!0,headers:{Accept:"application/json; odata=verbose"},success:function(a){b(a)},error:function(a){console.log(a)}})}function addItemToList(a){$.ajax({url:_spPageContextInfo.webAbsoluteUrl+"/_api/Web/Lists/GetByTitle('Liv_Chats_labeling_Report')/items",type:"POST",async:!1,contentType:"application/json;odata=verbose",data:JSON.stringify(a),headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val()},success:function(){reload()},error:function(a){alert("There was an error, please refresh and try again  or contact TL"),console.log(a)}})}function updateSpecificListItem(a,b){$.ajax({url:_spPageContextInfo.webAbsoluteUrl+"/_api/Web/Lists/GetByTitle('Liv_Chats_labeling_Report')/items("+b+")",type:"POST",data:JSON.stringify(a),contentType:"application/json;odata=verbose",headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"X-HTTP-Method":"MERGE","If-Match":"*"},success:function(){},error:function(a){alert("There was an error, please refresh and try again or contact TL"),console.log(a)}})}function reload(){bsAlert.show(),setTimeout(()=>{window.location.reload()},2e3)}$(".todayItems").on("click",()=>{location.href="liv-label-UserPage.aspx"});
