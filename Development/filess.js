const months=["January","February","March","April","May","June","July","August","September","October","November","December"];date=new Date,refinedDate=`${months[date.getMonth()]} ${date.getDate()}`;const regExp=/[0-9]/,userID=getUser().userId,cifLength=8,className=["bounce","shakeX","shakeY","pulse","backInUp","backInDown","bounceIn","fadeInUp","lightSpeedInLeft"],label_Contact=["Accounts","Credit_card","Debit_card","Liv_Cash","Liv_Insurance","Liv_Prime","Liv_USD","Liv_Young"],dateOptions={weekday:"long",year:"numeric",month:"long",day:"numeric"},dateNow=new Date().toLocaleDateString("en-US",dateOptions);$(document).ready(function(){$("#dateToday").val(dateNow)}),$("#staffName").val(getUser().fullName);var myAlert=document.getElementById("toastNotice"),bsAlert=new bootstrap.Toast(myAlert,{animation:!0,autohide:!0,delay:5e3}),rand=function(){var a=Math.random();return a=Math.floor(a*className.length),a};$("#layout3").addClass("animate__"+className[rand()]);var uniqueLabels,uniqueSubLabels,tempArrLabels=[],tempArrSubLabels=[];function loadLabelS(a){gettItems(a,null)}function loadSubLabels(a){var b=$("#labelViaCont").val();gettItems(b,a)}function createLabelSelection(){$("#LabelVal").html(""),$("#subLabeled").html(""),$("#LabelVal").append("<option value=\"\">--Select--</option>"),uniqueLabels.forEach(a=>$("#LabelVal").append(`<option value="${a}">${a}</option>`))}function createSubLabelSelection(){$("#subLabeled").html(""),uniqueSubLabels.forEach(a=>$("#subLabeled").append(`<option value="${a}">${a}</option>`))}function gettItems(a,b){null==b?tempArrLabels=[]:tempArrSubLabels=[];var c=null==b?"(labelVIaContact eq  '"+a+"')&$orderby=Label asc":"(Label eq '"+b+"') and (labelVIaContact eq '"+a+"')&$select=subLabel&$orderby=subLabel asc";var d=_spPageContextInfo.webAbsoluteUrl+"/_api/web/lists/getbytitle('Liv_Pending_Chat')/items?$top=1000&$filter="+c;$.ajax({url:d,type:"GET",headers:{accept:"application/json; odata=verbose"},success:function(a){var c=a.d.results;null==b?c.forEach(a=>tempArrLabels.push(a.Label)):c.forEach(a=>tempArrSubLabels.push(a.subLabel)),null==b?getUniqs("L"):getUniqs("subL")},error:function(){console.log("Error")}})}function getUniqs(a){"subL"==a?uniqueSubLabels=[]:uniqueLabels=[],"subL"==a?uniqueSubLabels=tempArrSubLabels.filter(onlyUnique):uniqueLabels=tempArrLabels.filter(onlyUnique),"subL"==a?createSubLabelSelection():createLabelSelection()}function onlyUnique(a,b,c){return c.indexOf(a)===b}function submitRecord(){const a=$("#emailID").val(),b=$("#labelViaCont").val(),c=$("#LabelVal").val(),d=$("#subLabeled").val();console.log([a,b,c,d]);var e={__metadata:{type:"SP.Data.Liv_x005f_Chats_x005f_labelingListItem"},Title:`${userID}`,Mobile_Number:a,Label_via_Contact_type:b,Label:c,Sub_Label:d,manualDateToday:refinedDate};""==a||null==a||""==b||""==c||null==c||""==d||null==d?alert("Please fill all fields"):(addItemToList(e),bsAlert.show(),setTimeout(()=>{window.location.reload()},500))}function addItemToList(a){$.ajax({url:_spPageContextInfo.webAbsoluteUrl+"/_api/Web/Lists/GetByTitle('Liv_Chats_labeling_Report')/items",type:"POST",async:!1,contentType:"application/json;odata=verbose",data:JSON.stringify(a),headers:{Accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val()},success:function(a){console.log(a)},error:function(a){console.log(a)}})}
